<html>
<meta charset=utf-8" />
<head>
    <p style="font-size: 20px;color: red;">使用a标签方式将json导出csv文件</p>
    <button onclick='JSONToExcel()'>导出</button>
</head>
<body>
<script>

    function JSONToExcel(){
        // 要导出的json数据，这部分数据可以来自ajax请求
        const jsonData = [
            {
                "name": "常健",
                "dept": "移动研发部",
                "id": "1",
                "attendance": 10,
                "rest": 20
            },
            {
                "name": "陈熙文",
                "dept": "移动研发部",
                "id": "2",
                "attendance": 20,
                "rest": 10
            },
            {
                "name": "迟野",
                "dept": "移动研发部",
                "id": "3",
                "attendance": 0,
                "rest": 30
            }
        ]
        //列标题，逗号隔开
        let str = `姓名,部门,id,考勤天数,休息天数\n`;
        //增加\t为了不让表格显示科学计数法或者其他格式
        for(let i = 0; i < jsonData.length; i++){
            for(let item in jsonData[i]){
                str+=`${jsonData[i][item] + '\t'},`;
            }
            str+='\n';
        }
        //encodeURIComponent解决中文乱码， \ufeff是 ""
        let uri = 'data:text/csv;charset=utf-8,\ufeff' + encodeURIComponent(str);
        //通过创建a标签实现
        let link = document.createElement("a");
        link.href = uri;
        //对下载的文件命名
        link.download =  "考勤月度统计.csv";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

</script>
</body>
</html>